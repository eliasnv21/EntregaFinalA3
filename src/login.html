<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MotionGames - Login</title>
    <link rel="stylesheet" href="login.css">
</head>
<body>
    <div class="img">
        <img src="icons/icon-login.png" alt="">
    </div>
    
    <div class="conteiner">
        <form action="">
            <h2>Faça o login</h2>
            <div class="email">
                <label id="email-label">E-mail</label>
                <img class="icon-email" src="icons/email.png">
                <input type="email" name="email" id="email">
            </div>
            <br>
            <div class="senha">
                <label>Senha</label>
                <input type="password" name="senha" id="password">
                <img class="icon-senha" src="icons/senha.png">
            </div>
            <br>
            <div class="line"></div>

            <div class="btn">
                <input type="button" value="Login" id="btn">
            </div>
            <br>

            <div class="register">
                Não tem uma conta?
                <a href="registro.html">Resgistrar</a>
            </div>
        </form>
    </div>
        <script> 
        document.addEventListener('DOMContentLoaded', function () {console.log('Código JavaScript em execução');
    
        const btnLogin = document.getElementById('btn');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');

        if (btnLogin && emailInput && passwordInput) {btnLogin.addEventListener('click', async function () {
            const email = emailInput.value;
            const senha = passwordInput.value;

            try {const response = await fetch('http://localhost:3000/login', {method: 'POST',headers: {'Content-Type': 'application/json',}, 
            body: JSON.stringify({ emailUsuario: email, senhaUsuario: senha }),});

                const data = await response.json();

                if (response.ok) {
                    console.log('Login bem-sucedido!');
                    alert('Login efetuado com sucesso!');
                    setTimeout(() => {window.location.href = 'http://localhost:8080/principal.html';}, 2000);
                } else {
                    console.log('Erro ao fazer login:', data.erro);
                    alert('Erro ao fazer login: ' + data.erro);
                }
            } catch (error) {
                console.error('Erro ao fazer login:', error);
            }
        });
        } else {
        console.error('Elementos do DOM não encontrados.');
        }
    });
        </script>
</body>
</html>